<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Race App Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }

    /* Custom alert styles */
    .custom-alert {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #22c55e;
      color: white;
      padding: 1.5rem 2.5rem;
      border-radius: 0.5rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      z-index: 1000;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
      max-width: 24rem;
      width: 100%;
    }

    .spoiler-content {
      transition: all 0.5s ease-in-out;
    }

    /* Style for the toggle switch */
    input:checked~.dot {
      transform: translateX(100%);
      background-color: #22c55e;
      /* Green when on */
    }

    input:checked~.block {
      background-color: #374151;
      /* Darker gray when on */
    }
  </style>
</head>

<body
  class="min-h-screen bg-gradient-to-br from-gray-900 to-black flex items-center justify-center p-4 font-inter text-gray-200">

  <div class="container mx-auto p-8 bg-zinc-900 rounded-xl shadow-2xl border-t-4 border-blue-600 max-w-4xl">
    <div class="flex justify-between items-center mb-8 pb-4 border-b border-gray-700">
      <div class="p-3 rounded-lg bg-gray-800 border border-gray-700 shadow-md">
        <span class="font-extrabold text-2xl text-blue-500 tracking-wider">RACE.APP</span>
      </div>
      <div class="flex items-center gap-4">
        <button id="showSavedDetailsBtn"
          class="p-3 rounded-lg bg-gray-800 border border-gray-700 shadow-md cursor-pointer hover:bg-gray-700 transition duration-300">
          <span class="font-bold text-lg text-amber-400">SAVED (<span id="savedCount">0</span>)</span>
        </button>
      </div>
    </div>

    <div class="mb-10 text-center md:text-left">
      <p class="text-2xl text-gray-100">
        Next Race: <span id="nextRaceName" class="text-orange-500 font-bold"></span> In
        <span id="countdownDays" class="text-red-500 font-extrabold">0</span> days,
        <span id="countdownHours" class="text-red-500 font-extrabold">0</span> hours,
        <span class="text-red-500 font-extrabold">0</span> minutes
      </p>
      <p class="text-lg text-gray-300">
        Circuit: <span id="nextRaceCircuit"></span>
      </p>
    </div>

    <div id="mainContent" class="mb-10 space-y-4">
      <div class="bg-gray-800 p-4 rounded-lg shadow-md border border-gray-700">
        <label for="raceNameSelect" class="block text-lg font-bold text-blue-400 mb-2">Race Name</label>
        <select id="raceNameSelect"
          class="w-full bg-gray-900 text-gray-200 border border-gray-600 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
          <option value="" disabled selected>Select a Race Name</option>
        </select>
      </div>

      <div id="teamDropdownContainer" class="bg-gray-800 p-4 rounded-lg shadow-md border border-gray-700 hidden">
        <label for="teamNamesSelect" class="block text-lg font-bold text-blue-400 mb-2">Team Name</label>
        <select id="teamNamesSelect"
          class="w-full bg-gray-900 text-gray-200 border border-gray-600 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
          <option value="" disabled selected>Select a Team Name</option>
        </select>
      </div>

      <div id="upgradesDropdownContainer" class="bg-gray-800 p-4 rounded-lg shadow-md border border-gray-700 hidden">
        <label for="upgradesNameSelect" class="block text-lg font-bold text-blue-400 mb-2">Upgrade Name</label>
        <select id="upgradesNameSelect"
          class="w-full bg-gray-900 text-gray-200 border border-gray-600 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
          <option value="" disabled selected>Select an Upgrade</option>
        </select>
      </div>
    </div>

    <div id="detailsCard" class="flex-col md:flex-row gap-8 mb-8 hidden">
      <div class="relative flex-1 bg-gray-800 border border-gray-700 p-8 rounded-xl shadow-lg">
        <h3 class="font-bold text-2xl mb-4 text-white">Details</h3>

        <p class="mb-3 text-gray-300"><span class="font-semibold text-white">Part Name:</span> <span
            id="detailPartName"></span></p>
        <p class="mb-3 text-gray-300"><span class="font-semibold text-white">Reason for upgrade:</span> <span
            id="detailPrimaryReason"></span></p>
        <p class="mb-3 text-gray-300"><span class="font-semibold text-white">Geometric Differences:</span> <span
            id="detailGeometricDifferences"></span></p>
        <p class="text-gray-300"><span class="font-semibold text-white">Description:</span> <span
            id="detailDescription"></span></p>

        <div id="spoilerSectionInCard" class="hidden mt-6 pt-6 border-t border-gray-700">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-bold text-red-400">Spoilers</h3>
            <label for="spoilerToggle" class="flex items-center cursor-pointer">
              <span class="mr-3 text-gray-300">Show Results</span>
              <div class="relative">
                <input type="checkbox" id="spoilerToggle" class="sr-only">
                <div class="block bg-gray-600 w-14 h-8 rounded-full"></div>
                <div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition"></div>
              </div>
            </label>
          </div>
          <div id="spoilerContent" class="spoiler-content max-h-0 overflow-hidden mt-4">
            <div id="spoilerResults" class="text-gray-300 space-y-3">
              <p>Toggle on to see results.</p>
            </div>
            <div class="my-8 pt-6 border-t border-gray-700"></div>
            <div class="session-container">
                </div>
          </div>
        </div>

        <button id="saveDetailBtn"
          class="mt-8 px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-300 shadow-xl font-bold tracking-wide">
          Save Detail Card <span class="ml-2">&#10003;</span>
        </button>
      </div>
    </div>

    <div id="savedDetailsView"
      class="bg-zinc-800 border border-zinc-700 p-8 rounded-xl shadow-2xl w-full max-w-4xl mx-auto hidden">
      <h3 class="font-bold text-2xl mb-6 text-white text-center">Your Saved Details</h3>
      <div id="savedDetailsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        </div>
      <button id="backToMainBtn"
        class="mt-8 px-8 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition duration-300 shadow-lg font-bold mx-auto block">
        Back to Main
      </button>
    </div>

    <div id="customAlert" class="custom-alert hidden">
      <p id="alertMessage" class="text-lg font-semibold"></p>
      <button id="closeAlertBtn"
        class="bg-green-700 hover:bg-green-800 text-white font-bold py-2 px-6 rounded-md transition duration-300">
        OK
      </button>
    </div>
  </div>

  <script>
    // Data Definitions with API mapping for 2025
    const raceSchedule = [
        { name: "Louis Vuitton Australian GP", circuit: "Melbourne Grand Prix Circuit", location: "Melbourne", raceDate: new Date("2025-03-16T12:00:00"), apiMeetingName: "Australian Grand Prix" },
        { name: "Heineken Chinese GP", circuit: "Shanghai International Circuit", location: "Shanghai", raceDate: new Date("2025-03-23T12:00:00"), apiMeetingName: "Chinese Grand Prix" },
        { name: "Lenovo Japanese GP", circuit: "Suzuka International Racing Course", location: "Suzuka", raceDate: new Date("2025-04-06T12:00:00"), apiMeetingName: "Japanese Grand Prix" },
        { name: "Gulf Air Bahrain GP", circuit: "Bahrain International Circuit", location: "Sakhir", raceDate: new Date("2025-04-13T12:00:00"), apiMeetingName: "Bahrain Grand Prix" },
        { name: "STC Saudi Arabian GP", circuit: "Jeddah Street Circuit", location: "Jeddah", raceDate: new Date("2025-04-20T12:00:00"), apiMeetingName: "Saudi Arabian Grand Prix" },
        { name: "Crypto.com Miami GP", circuit: "Miami International Autodrome", location: "Miami", raceDate: new Date("2025-05-04T12:00:00"), apiMeetingName: "Miami Grand Prix" },
        { name: "AWS Made in Italy Emilia Romagna GP", circuit: "Autodromo Enzo e Dino Ferrari", location: "Imola", raceDate: new Date("2025-05-18T12:00:00"), apiMeetingName: "Emilia Romagna Grand Prix" },
        { name: "Tag Heuer Monaco GP", circuit: "Circuit de Monaco", location: "Monaco", raceDate: new Date("2025-05-25T12:00:00"), apiMeetingName: "Monaco Grand Prix" },
        { name: "Aramco Spanish GP", circuit: "Circuit de Barcelona-Catalunya", location: "Barcelona", raceDate: new Date("2025-06-01T12:00:00"), apiMeetingName: "Spanish Grand Prix" },
        { name: "Pirelli Canadian GP", circuit: "Circuit Gilles-Villeneuve", location: "Montréal", raceDate: new Date("2025-06-15T12:00:00"), apiMeetingName: "Canadian Grand Prix" },
        { name: "MSC Cruises Austrian GP", circuit: "Red Bull Ring", location: "Spielberg", raceDate: new Date("2025-06-29T12:00:00"), apiMeetingName: "Austrian Grand Prix" },
        { name: "Qatar Airways British GP", circuit: "Silverstone Circuit", location: "Silverstone", raceDate: new Date("2025-07-06T12:00:00"), apiMeetingName: "British Grand Prix" },
        { name: "Moët & Chandon Belgian GP", circuit: "Circuit de Spa-Francorchamps", location: "Spa-Francorchamps", raceDate: new Date("2025-07-27T09:00:00"), apiMeetingName: "Belgian Grand Prix" },
        { name: "Lenovo Hungarian GP", circuit: "Hungaroring", location: "Budapest", raceDate: new Date("2025-08-03T09:00:00"), apiMeetingName: "Hungarian Grand Prix" },
        { name: "Heineken Dutch GP", circuit: "Circuit Park Zandvoort", location: "Zandvoort", raceDate: new Date("2025-08-31T09:00:00"), apiMeetingName: "Dutch Grand Prix" },
        { name: "Pirelli Italian GP", circuit: "Autodromo Nazionale Monza", location: "Monza", raceDate: new Date("2025-09-07T09:00:00"), apiMeetingName: "Italian Grand Prix" },
        { name: "Qatar Airways Azerbaijan GP", circuit: "Baku City Circuit", location: "Baku", raceDate: new Date("2025-09-21T07:00:00"), apiMeetingName: "Azerbaijan Grand Prix" },
        { name: "Singapore Airlines Singapore GP", circuit: "Marina Bay Street Circuit", location: "Singapore", raceDate: new Date("2025-10-05T08:00:00"), apiMeetingName: "Singapore Grand Prix" },
        { name: "MSC Cruises United States GP", circuit: "Circuit of the Americas", location: "Austin", raceDate: new Date("2025-10-19T15:00:00"), apiMeetingName: "United States Grand Prix" },
        { name: "Mexico City GP", circuit: "Autodromo Hermanos Rodriguez", location: "Mexico City", raceDate: new Date("2025-10-26T16:00:00"), apiMeetingName: "Mexico City Grand Prix" },
        { name: "MSC Cruises São Paulo GP", circuit: "Autodromo Jose Carlos Pace", location: "São Paulo", raceDate: new Date("2025-11-09T12:00:00"), apiMeetingName: "São Paulo Grand Prix" },
        { name: "Heineken Las Vegas GP", circuit: "Las Vegas Street Circuit", location: "Las Vegas", raceDate: new Date("2025-11-22T23:00:00"), apiMeetingName: "Las Vegas Grand Prix" },
        { name: "Qatar Airways Qatar GP", circuit: "Losail International Circuit", location: "Lusail", raceDate: new Date("2025-11-30T11:00:00"), apiMeetingName: "Qatar Grand Prix" },
        { name: "Etihad Airways Abu Dhabi GP", circuit: "Yas Marina Circuit", location: "Yas Island", raceDate: new Date("2025-12-07T08:00:00"), apiMeetingName: "Abu Dhabi Grand Prix" },
    ];

   const upgradeData = [
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "MCLAREN F1 TEAM", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Floor Body", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Revised floor geometry", "Description": "The complete floor has been revised resulting in improved flow conditioning and a redistribution of suction to gain overall aerodynamic performance." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "MCLAREN F1 TEAM", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Rear Corner", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "Revised Rear Corner Inlet", "Description": "Modification to Rear Brake Duct Inlet aiming at overall improvement in local flow conditioning for improved aerodynamic and brake cooling performance." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "Red Bull Racing", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Floor Body", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Re-profiled surfaces to supplement the changes to the fences", "Description": "Revised surfaces to improve pressure distribution over the length of the floor allowing more load to be extracted whilst maintaining adequate flow stability." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "Aston Martin Aramco F1 Team", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Floor Body", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "The shape of the main body of the floor has evolved slightly as part of this update.", "Description": "The revised surfaces improve the flow structures under the floor increasing the local load on the lower surface and hence improving performance." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "Aston Martin Aramco F1 Team", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Floor Fences", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "The fences have revised curvature and local details.", "Description": "The revised surfaces improve the flow structures under the floor increasing the local load on the lower surface and hence improving performance." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "Aston Martin Aramco F1 Team", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Floor Edge", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Small changes to the details of the floor edge wing and the main floor inboard of this.", "Description": "The revised surfaces improve the flow structures under the floor increasing the local load on the lower surface and hence improving performance." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "Aston Martin Aramco F1 Team", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 4, "UpdatedComponent": "Coke/Engine Cover", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Change to the profile of the top deck of the bodywork.", "Description": "This revised shape is developed alongside the floor edge details to improve the performance of the floor as above." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "MONEYGRAM HAAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Floor Body", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Expansion rate changed on main floor", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "MONEYGRAM HAAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Floor Fences", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Fences re-aligned", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "MONEYGRAM HAAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Floor Edge", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Smaller Floor edge wing", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "MONEYGRAM HAAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 4, "UpdatedComponent": "Sidepod Inlet", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "Profiled Sidepod Inlet geometry and Mirror update", "Description": "The revised sidepod inlet improves local flow alignment, enabling cleaner airflow delivery to the rear of the car, hence improving overall car performance." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "Visa Cash App Racing Bulls", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Wing", "PrimaryReason": "Circuit specific - Balance Range", "GeometricDifferences": "New front wing flap geometry.", "Description": "The flap elements has been changed for smaller profiles, to cater for the low balance requirements of this and subsequent events." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "ATLASSIAN WILLIAMS RACING", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Floor Fences", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "STAKE F1 TEAM KICK SAUBER", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Floor Body", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Changes to forward floor area.", "Description": "In continuation of recent floor development, new forward floor geometry modifications are implemented at this event, gaining some efficient downforce." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Qatar Airways British GP", "Constructor": "STAKE F1 TEAM KICK SAUBER", "RequiredEventDisplay": "FORMULA 1 BRITISH GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Front Wing", "PrimaryReason": "Circuit specific - Balance Range", "GeometricDifferences": "New front wing flap design", "Description": "New front wing flap design with a reshaped flap geometry to provide a more efficient low balance flap option if lower downforce levels are used at this event." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "MCLAREN F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Rear Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "Medium-High Downforce Rear Wing", "Description": "A medium-high Downforce Rear Wing sitting between the medium and high downforce Rear Wing assemblies has been made available for this track, featuring an efficient reduction in Drag compared to the high downforce wing." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "MCLAREN F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Beam Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "Medium-High Downforce Beam Wing", "Description": "In order to ensure the high downforce Rear Wing assembly is suitable across multiple circuits, a Beamwing with medium-high level of load has been designed alongside the aforementioned assembly." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "MCLAREN F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Beam Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "Medium Downforce Beam Wing", "Description": "In order to ensure the high downforce Rear Wing assembly is suitable across multiple circuits, a Beamwing with a medium level of load has been designed alongside the aforementioned assembly." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "MCLAREN F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 4, "UpdatedComponent": "Front Suspension", "PrimaryReason": "Performance - Mechanical Setup", "GeometricDifferences": "Front Suspension Geometry Update", "Description": "In order to deal with the unique cornering challenges that this circuit brings, the front suspension geometry has been modified." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "MCLAREN F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 5, "UpdatedComponent": "Front Corner", "PrimaryReason": "Circuit specific - Cooling Range", "GeometricDifferences": "Increased Front Brake Cooling Option", "Description": "Given the significant brake cooling demand of this circuit, an option to increase brake cooling on the front axle is available to deploy should this be required." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "SCUDERIA FERRARI HP", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Suspension", "PrimaryReason": "Circuit specific", "GeometricDifferences": "Modification to trackrod / suspension fairings and FBD scoop clearance", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "SCUDERIA FERRARI HP", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Front Corner", "PrimaryReason": "", "GeometricDifferences": "", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "SCUDERIA FERRARI HP", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Beam Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "Higher Downforce Top Rear Wing and Lower Rear Wing designs", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "SCUDERIA FERRARI HP", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 4, "UpdatedComponent": "Rear Wing", "PrimaryReason": "", "GeometricDifferences": "", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "Red Bull Racing", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Rear wing", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Enlarged rear wing upper and beam, for camber and chord", "Description": "The Monaco circuit rearwards aerodynamic load and the enlarged rear wing plus beam wing provides this at the lower car speeds encountered" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "Red Bull Racing", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Front Suspension", "PrimaryReason": "Reliability", "GeometricDifferences": "Revised wishbone faring", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "Red Bull Racing", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Front Corner", "PrimaryReason": "Reliability", "GeometricDifferences": "Revised exit duct and gaitor", "Description": "To attain the necessary cooling for the front brakes, a larger exit duct is available with a consequential trim to the gaitor sealing the upper wishbone." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "Aston Martin Aramco F1 Team", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Wing", "PrimaryReason": "Circuit specific - Balance Range", "GeometricDifferences": "Front wing flap with more aggressive profiles.", "Description": "This is a higher loaded front wing flap to achieve the desired car setup to balance the more powerful rear wing also introduced at this event." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "Aston Martin Aramco F1 Team", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Rear Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "More aggressive rear wing with more surface area.", "Description": "This rear wing generates more load than the versions which have been used previously this season and is introduced due the characteristics of this circuit." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "Aston Martin Aramco F1 Team", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Rear Corner", "PrimaryReason": "Circuit specific - Cooling Range", "GeometricDifferences": "The inlet is increased and the exit duct and the vanes surrounding it have been revised.", "Description": "The inlet and exit changes increase flow through the duct and hence cooling. The geometry has increased loading on the surfaces of the devices so raising the local load generated in the area." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "BWT ALPINE F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Suspension", "PrimaryReason": "Performance – Mechanical Setup", "GeometricDifferences": "New trackrod fairing and supports to suit Monaco racetrack", "Description": "This modification to the front suspension increases the road wheel angle. This modification is needed for the specific circuit characteristics." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "BWT ALPINE F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Rear Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "More loaded top rear wing main plane", "Description": "The top rear wing is more loaded, delivering more downforce and offering the best lap-time for the specific circuit characteristics of Monaco" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "BWT ALPINE F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Beam Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "Rear beam wing designed to work with the top rear wing update", "Description": "Similar to the rear wing, the beam wing features more load with the objective of delivering the best lap-time around Monaco." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "MONEYGRAM HAAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Rear Wing", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "More cambered RW profile cluster", "Description": "This circuit-specific rear wing uses the full regulation box to maximize downforce, accepting the associated drag increase, which is less penalizing in Monaco compared to other circuits" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "MONEYGRAM HAAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Beam Wing", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "More cambered Lower Rear Wing Profiles", "Description": "This option is tailored to operate with the more aggressive rear wing design, continuing to aim for increased downforce." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "MONEYGRAM HAAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Front Suspension", "PrimaryReason": "Performance - Mechanical Setup", "GeometricDifferences": "Front Trackrod position", "Description": "A minor adjustment to the front trackrod was needed to meet the circuit-specific steering angle requirements." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "Visa Cash App Racing Bulls", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Corner", "PrimaryReason": "Circuit specific – Mechanical Setup", "GeometricDifferences": "The shape of the cooling exit duct and trackrod ends has been adjusted to increase clearance for high steer angles", "Description": "The steering angle required at Monaco increases the clearance requirements between suspension & brake duct components. This update addresses these clearance issues with a minimal change on aerodynamic performance." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "Visa Cash App Racing Bulls", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Beam Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "A new double-element high downforce beam wing.", "Description": "The highly cambered and high incidence elements increase the downforce generated by the beam wing, whilst aerodynamically supporting the flow attachment of the upper wing." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "Visa Cash App Racing Bulls", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Rear Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "A new max downforce upper wing.", "Description": "The camber of the upper wing profiles is increased to maximise the load generated. The tip shape helps to improve the overall efficiency." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "ATLASSIAN WILLIAMS RACING", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Rear Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "The rear wing for Monaco is a larger wing overall with a high angle of attack. It is the 2024 RWing that we ran in Monaco last year.", "Description": "The larger upper rear wing delivers more downforce and" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "ATLASSIAN WILLIAMS RACING", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Beam Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "", "Description": "The larger beam wings and pylon wing work together to" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "ATLASSIAN WILLIAMS RACING", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Front Suspension", "PrimaryReason": "Performance - Mechanical Setup", "GeometricDifferences": "", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "ATLASSIAN WILLIAMS RACING", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 4, "UpdatedComponent": "Front Corner", "PrimaryReason": "Circuit specific - Cooling Range", "GeometricDifferences": "There is a larger exit available for the front brake duct. This increases the brake disc/caliper cooling, which is appropriate for Monaco.", "Description": "The larger exit simply allows more air to flow through the brake duct assembly and therefore provides more cooling to the brake components. This effectively compensates for the lower straight-line speed in Monaco and the increased brake duty." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "STAKE F1 TEAM KICK SAUBER", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Rear Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "High downforce rear wing assembly", "Description": "For this specific track and future events, we have introduced a new high-downforce rear wing assembly, which efficiently increases load." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Tag Heuer Monaco GP", "Constructor": "STAKE F1 TEAM KICK SAUBER", "RequiredEventDisplay": "FORMULA 1 MONACO GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Front Corner", "PrimaryReason": "Circuit specific - Cooling Range", "GeometricDifferences": "New front brake duct design", "Description": "The new design offers an increased brake system cooling flow to accommodate the low average airspeed of this specific track." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "SCUDERIA FERRARI HP", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Wing", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Update of chordwise and spanwise loading distribution of the wing elements, together with a revised endplate and outboard tip rolls", "Description": "Not track specific, this front wing introduction is phased with the update of the articles 3.15.4 and 3.15.5 of the technical regulations, effective from the Spanish Grand Prix onwards" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "SCUDERIA FERRARI HP", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Rear Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "Redesign of the outboard tip and roll on the high downforce top rear wing", "Description": "The high downforce top rear wing, carried over from 2024 and made available in Imola, received a local update to the outboard tip and roll geometries. Local flow features are improved, returning an efficient load increase." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "Red Bull Racing", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front wing", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "First and second elements revised primarily in section. Flap elements and tips are consequential to the first two elements.", "Description": "In order to comply with the revisions to the 2025 F1 Technical Regulations applicable from the Spanish GP, the front wing geometry has been revised to gain stiffness at minimal weight cost and then iterated to pursue the load characteristics sought." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "MERCEDES-AMG PETRONAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Floor Edge", "PrimaryReason": "Performance – Local Load", "GeometricDifferences": "Increased chord floor edge wing with additional vanes", "Description": "Additional vane elements and flap chord increases mass flow under forward floor, increasing vorticity shed from the fence system, increasing floor load." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "MERCEDES-AMG PETRONAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Floor Fences", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "Reprofiled inboard fence", "Description": "New fence profile has improved local pressure distribution and position of vorticity, improving both local and downstream load through better onset flow." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "MERCEDES-AMG PETRONAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Rear Wing", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Reprofiled mainplane and flap elements", "Description": "Circuit specific rear wing, with increased camber aimed at gaining local downforce and drag along an efficiency slope appropriate for Barcelona." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "Aston Martin Aramco F1 Team", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Wing", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Revised tip detail between the front wing elements and the endplate. Main wing sections also revised for compliance with TD018H.", "Description": "The revised tip detail improves the flowfield around the outboard end of the wing increasing the load generated in that area. Changes in section are for structural reasons." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "BWT ALPINE F1 TEAM", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Floor Fences", "PrimaryReason": "Performance – Local load", "GeometricDifferences": "Reprofiled floor fences", "Description": "The floor fences have been optimised locally to improve the quality of the underfloor structures. This results in an improved flow delivery to the entire floor and generates local load." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "BWT ALPINE F1 TEAM", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Floor Body", "PrimaryReason": "Performance – Local load", "GeometricDifferences": "Local changes to the shape of the floor", "Description": "Local and subtle modifications have been done to the floor to maximise the effect of the updated fences and improve the flowfield quality." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "MONEYGRAM HAAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Wing", "PrimaryReason": "Performance - Mechanical Setup", "GeometricDifferences": "Updated Front Wing Construction", "Description": "The 2025 Technical Regulations were updated on" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "Visa Cash App Racing Bulls", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Wing", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "The elements of the mainplane are new, featuring a lower central section.", "Description": "The centre section of the wing is loaded further relative to the outboard, modifying the downstream flow conditions. This update also addresses the increased FW stiffness requirements for race 09 onwards." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "Visa Cash App Racing Bulls", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Front Wing Endplate", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "The connection between the tips & the FWEP has been updated.", "Description": "The flow around the FW tips is highly three- dimensional. The revised detail around the tips helps to reduce the losses created from this flow field." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "Visa Cash App Racing Bulls", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Nose", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "The lower surface of the nose has been raised whilst the tip has been lowered.", "Description": "The nose tip drops down to meet the new FW sections, whilst the raised lower surface helps to increase the load generated by the centre section of the wing, which in turn modifies the downstream flow around the car." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "ATLASSIAN WILLIAMS RACING", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Wing", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "ATLASSIAN WILLIAMS RACING", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Rear Corner", "PrimaryReason": "Circuit specific - Cooling Range", "GeometricDifferences": "There is a revised exit geometry for the rear brake duct, which constricts the flow through the brake duct.", "Description": "The revised exit geometry changes the flow rate through the brake duct and affects the brake cooling in a way that is suitable for the braking demands of Barcelona." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "ATLASSIAN WILLIAMS RACING", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Cooling Louvres", "PrimaryReason": "Circuit specific - Cooling Range", "GeometricDifferences": "A new optional cooling louvre panel is available for this event. It increases the number of large louvres to the maximum that the panel can accommodate.", "Description": "This update simply increases the flow through the radiators and therefore increases the PU cooling at the cost of downforce and drag. This will be our new maximum cooling setup, which may be of use in Barcelona, but is more likely to be needed later in the season." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "STAKE F1 TEAM KICK SAUBER", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Floor Body", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Changes to several areas of the floor: Floor fence, outboard floor edge and diffuser.", "Description": "Modifications are targeted at improved flow field conditions for the underfloor from front to back, gaining some efficient and balanced downforce." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "STAKE F1 TEAM KICK SAUBER", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Coke/Engine Cover", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Changes to engine cover design.", "Description": "Sidepod surfaces have been updated to adapt to the new floor developments and associated interactions, modifying floor top surface flow conditions." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Aramco Spanish GP", "Constructor": "STAKE F1 TEAM KICK SAUBER", "RequiredEventDisplay": "FORMULA 1 SPANISH GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Front Wing", "PrimaryReason": "Performance - Local Load", "GeometricDifferences": "Small change to the transition between the mainplane and the front wing endplate.", "Description": "Local front wing end plate developments to improve outboard front wing performance and efficiency and also encourage better downstream flow quality." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Pirelli Canadian GP", "Constructor": "MCLAREN F1 TEAM", "RequiredEventDisplay": "FORMULA 1 CANADIAN GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Wing", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "New Front Wing geometry", "Description": "A revised front wing geometry aiming at improved aerodynamic performance across a wide range of attitudes, through a redesign of main elements as well as introduction of 'mermaid tails' to the front wing endplate." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Pirelli Canadian GP", "Constructor": "MCLAREN F1 TEAM", "RequiredEventDisplay": "FORMULA 1 CANADIAN GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Rear Wing", "PrimaryReason": "Circuit specific - Drag Range", "GeometricDifferences": "Medium Downforce Rear Wing", "Description": "Updated version of the medium downforce rear wing assembly, enabling a more efficient coverage of a larger drag range, suitable for multiple circuits." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Pirelli Canadian GP", "Constructor": "MCLAREN F1 TEAM", "RequiredEventDisplay": "FORMULA 1 CANADIAN GRAND PRIX 2025", "ComponentNo": 3, "UpdatedComponent": "Front Suspension", "PrimaryReason": "Performance - Mechanical Setup", "GeometricDifferences": "Updated Front Suspension Geometry", "Description": "A small modification to the front suspension geometry which comes with an updated aerodynamic surface, to accommodate the geometry change and reoptimize local flow conditioning." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Pirelli Canadian GP", "Constructor": "MERCEDES-AMG PETRONAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 CANADIAN GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Floor Corner", "PrimaryReason": "Circuit Specific – Cooling Range", "GeometricDifferences": "Large brake duct inlet and exit", "Description": "" },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Pirelli Canadian GP", "Constructor": "MERCEDES-AMG PETRONAS F1 TEAM", "RequiredEventDisplay": "FORMULA 1 CANADIAN GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Floor Edge", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "Reduced chord wing element", "Description": "Reduced flap chord and tweaked vanes, increases mass flow under forward floor and vorticity shed from the fence system, increasing floor load." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Pirelli Canadian GP", "Constructor": "Aston Martin Aramco F1 Team", "RequiredEventDisplay": "FORMULA 1 CANADIAN GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Corner", "PrimaryReason": "Circuit specific - Cooling Range", "GeometricDifferences": "Front brake duct with larger exit.", "Description": "The larger exit area for the front brake duct increases the massflow through the front corner increasing cooling for the characteristics of this circuit." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Pirelli Canadian GP", "Constructor": "BWT ALPINE F1 TEAM", "RequiredEventDisplay": "FORMULA 1 CANADIAN GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front wing", "PrimaryReason": "Circuit specific - Balance Range", "GeometricDifferences": "Reprofiled and shorter flap", "Description": "The flap has been shortened and redesigned, generating less load, therefore offering the aero- balance range that may be required for the track characteristics." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Pirelli Canadian GP", "Constructor": "Visa Cash App Racing Bulls", "RequiredEventDisplay": "FORMULA 1 CANADIAN GRAND PRIX 2025", "ComponentNo": 1, "UpdatedComponent": "Front Wing", "PrimaryReason": "Circuit specific - Balance Range", "GeometricDifferences": "The most rearward element of the front flap features a shorter chord length.", "Description": "At lower rear wing levels, the car must be balanced with reduced front downforce. This reduced-chord flap allows the aerodynamic balance to be lowered beyond the minimum range achievable by the previous flap. It achieves this by reducing the load generated by the front wing at a given flap angle." },
      { "Year": 2025, "RaceNo": 12, "RaceName": "Pirelli Canadian GP", "Constructor": "Visa Cash App Racing Bulls", "RequiredEventDisplay": "FORMULA 1 CANADIAN GRAND PRIX 2025", "ComponentNo": 2, "UpdatedComponent": "Rear Corner", "PrimaryReason": "Performance - Flow Conditioning", "GeometricDifferences": "The shape of the lower winglet endplate has been revised.", "Description": "The vorticity shed from the brake drum winglet helps to manage the airflow around the tyre and the diffuser. This update improves the quality and consistency of the shed vortex, which in turn increases rear downforce." },
      {
        "Year": 2025,
        "RaceNo": 12,
        "RaceName": "Lenovo Japanese GP",
        "Constructor": "Red Bull Racing",
        "RequiredEventDisplay": "FORMULA 1 JAPANESE GRAND PRIX 2025",
        "ComponentNo": 1,
        "UpdatedComponent": "Coke/Engine Cover",
        "PrimaryReason": "Reliability",
        "GeometricDifferences": "Revision to central exit aspect ratio",
        "Description": ""
      },
      {
        "Year": 2025,
        "RaceNo": 12,
        "RaceName": "Lenovo Japanese GP",
        "Constructor": "Red Bull Racing",
        "RequiredEventDisplay": "FORMULA 1 JAPANESE GRAND PRIX 2025",
        "ComponentNo": 2,
        "UpdatedComponent": "Rear corner",
        "PrimaryReason": "Reliability",
        "GeometricDifferences": "Enlarged exit duct with blanking options",
        "Description": "In preparation for upcoming races, a larger exit duct has been prepared with scope to blank primarily for Suzuka"
      },
      {
        "Year": 2025,
        "RaceNo": 12,
        "RaceName": "Lenovo Japanese GP",
        "Constructor": "Red Bull Racing",
        "RequiredEventDisplay": "FORMULA 1 JAPANESE GRAND PRIX 2025",
        "ComponentNo": 3,
        "UpdatedComponent": "Rear Suspension",
        "PrimaryReason": "Performance - Local Load",
        "GeometricDifferences": "Mild revision to lower wishbone shroud and fairing into the rear wheel bodywork.",
        "Description": "Gap between races allowed a revised wishbone shroud better aligned to the local flow conditions to be applied with attendant fairing into the brake duct assembly."
      },
      {
        "Year": 2025,
        "RaceNo": 12,
        "RaceName": "Lenovo Japanese GP",
        "Constructor": "MONEYGRAM HAAS F1 TEAM",
        "RequiredEventDisplay": "FORMULA 1 JAPANESE GRAND PRIX 2025",
        "ComponentNo": 1,
        "UpdatedComponent": "Floor Body",
        "PrimaryReason": "Performance - Local Load",
        "GeometricDifferences": "Central floor re-shaped",
        "Description": "This geometry changes the floor volume in floor"
      },
      {
        "Year": 2025,
        "RaceNo": 12,
        "RaceName": "Lenovo Japanese GP",
        "Constructor": "Visa Cash App Racing Bulls",
        "RequiredEventDisplay": "FORMULA 1 JAPANESE GRAND PRIX 2025",
        "ComponentNo": 1,
        "UpdatedComponent": "Halo",
        "PrimaryReason": "Performance - Flow Conditioning",
        "GeometricDifferences": "Reprofiled Halo shroud and interface to chassis.",
        "Description": "The airflow passing over the Halo passes towards the back of the car and can influence the rear wing and floor performance. This update improves the flow quality downstream of the Halo."
      },
      {
        "Year": 2025,
        "RaceNo": 12,
        "RaceName": "Lenovo Japanese GP",
        "Constructor": "ATLASSIAN WILLIAMS RACING",
        "RequiredEventDisplay": "FORMULA 1 JAPANESE GRAND PRIX 2025",
        "ComponentNo": 1,
        "UpdatedComponent": "Front Wing Flap",
        "PrimaryReason": "Performance – Local Load",
        "GeometricDifferences": "",
        "Description": "The updated flap geometry produces more local load, which"
      },
      {
        "Year": 2025,
        "RaceNo": 12,
        "RaceName": "Lenovo Japanese GP",
        "Constructor": "ATLASSIAN WILLIAMS RACING",
        "RequiredEventDisplay": "FORMULA 1 JAPANESE GRAND PRIX 2025",
        "ComponentNo": 2,
        "UpdatedComponent": "Front Wing Endplate",
        "PrimaryReason": "Performance – Flow Conditioning",
        "GeometricDifferences": "The new endplate has a reprofiled lower rear edge and a slightly modified connection to the front wing flap.",
        "Description": "Working in conjunction with the new flap, the revisions to the endplate modify the flow leaving the front wing assembly and improve its interaction with the downstream aero devices."
      },
      {
        "Year": 2025,
        "RaceNo": 12,
        "RaceName": "Lenovo Japanese GP",
        "Constructor": "STAKE F1 TEAM KICK SAUBER",
        "RequiredEventDisplay": "FORMULA 1 JAPANESE GRAND PRIX 2025",
        "ComponentNo": 1,
        "UpdatedComponent": "Floor Body",
        "PrimaryReason": "Performance - Local Load",
        "GeometricDifferences": "",
        "Description": ""
      },
      {
        "Year": 2025,
        "RaceNo": 12,
        "RaceName": "Lenovo Japanese GP",
        "Constructor": "STAKE F1 TEAM KICK SAUBER",
        "RequiredEventDisplay": "FORMULA 1 JAPANESE GRAND PRIX 2025",
        "ComponentNo": 2,
        "UpdatedComponent": "Rear Wing",
        "PrimaryReason": "Performance - Local Load",
        "GeometricDifferences": "Changes to main plane.",
        "Description": "Changes to the main plane geometry to increase overall efficiency and improved cleanliness of the rear wing assembly."
      },
      {
        "Year": 2025,
        "RaceNo": 12,
        "RaceName": "Lenovo Japanese GP",
        "Constructor": "STAKE F1 TEAM KICK SAUBER",
        "RequiredEventDisplay": "FORMULA 1 JAPANESE GRAND PRIX 2025",
        "ComponentNo": 3,
        "UpdatedComponent": "Beam Wing",
        "PrimaryReason": "Performance - Local Load",
        "GeometricDifferences": "",
        "Description": ""
      },
      {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "MCLAREN F1 TEAM",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Front Suspension",
    "PrimaryReason": "Performance - Flow Conditioning",
    "GeometricDifferences": "Updated Front Suspension",
    "Description": "A revision to the Front Suspension fairings aiming at an overall improvement of flow conditioning which results in an aerodynamic performance gain."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "MCLAREN F1 TEAM",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Front Corner",
    "PrimaryReason": "Performance - Flow Conditioning",
    "GeometricDifferences": "Modified Front Corner",
    "Description": "Complementing the aforementioned Front Suspension changes, the aerodynamic devices on the front corner have been adopted to allow full exploitation of the flow conditioning improvements."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "MCLAREN F1 TEAM",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 3,
    "UpdatedComponent": "Rear Corner",
    "PrimaryReason": "Performance - Mechanical Setup",
    "GeometricDifferences": "Revised Rear Corner",
    "Description": "Alternative rear suspension geometry which requires a revision of rear corner aerodynamic surfaces to maintain clearances as well as aerodynamic performance."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "SCUDERIA FERRARI HP",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Floor Fences",
    "PrimaryReason": "",
    "GeometricDifferences": "Redistribution of fences profiles / camber",
    "Description": ""
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "SCUDERIA FERRARI HP",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Floor Body",
    "PrimaryReason": "",
    "GeometricDifferences": "Reshaped boat and tunnel expansion",
    "Description": ""
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "SCUDERIA FERRARI HP",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 3,
    "UpdatedComponent": "Floor Edge",
    "PrimaryReason": "",
    "GeometricDifferences": "Shorter and re-cambered front floor edge wing",
    "Description": ""
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "SCUDERIA FERRARI HP",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 4,
    "UpdatedComponent": "Diffuser",
    "PrimaryReason": "",
    "GeometricDifferences": "Redesigned diffuser volume",
    "Description": ""
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "Red Bull Racing",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Floor Edge",
    "PrimaryReason": "Performance - Local Load",
    "GeometricDifferences": "New surfaces with a vent ahead of the rear tyre",
    "Description": "A new edge wing is being deployed intended to maintain the established flow stability and improve the load extracted from this region of the floor."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "MERCEDES-AMG PETRONAS F1 TEAM",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Front Corner",
    "PrimaryReason": "Circuit Specific – Cooling Range",
    "GeometricDifferences": "Large brake duct inlet and exit.",
    "Description": "Increased front brake duct inlet and exit area to cover off the high brake duty that we typically see at this circuit."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "MERCEDES-AMG PETRONAS F1 TEAM",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Coke/Engine Cover",
    "PrimaryReason": "Circuit Specific – Cooling Range",
    "GeometricDifferences": "Large rear bodywork exit.",
    "Description": "Increased bodywork exit area designed to increase mass flow through the sidepod radiator and hence provide the additional cooling required for this circuit."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "Visa Cash App Racing Bulls",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Front Wing",
    "PrimaryReason": "Performance - Flow Conditioning",
    "GeometricDifferences": "New front wing flap geometry.",
    "Description": "The flap has been changed to improve local flow conditioning and help increase aerodynamic performance across a range of conditions."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "Visa Cash App Racing Bulls",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Rear Wing",
    "PrimaryReason": "Circuit specific - Drag Range",
    "GeometricDifferences": "Updated rear wing profiles.",
    "Description": "The upper rear wing has been changed to meet the needs of the target downforce & efficiency level for the circuit."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "STAKE F1 TEAM KICK SAUBER",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Floor Body",
    "PrimaryReason": "Performance - Local Load",
    "GeometricDifferences": "Changes to mid floor area incl. outboard floor edge and diffuser.",
    "Description": "Modifications are targeted at improved flow field conditions for the underfloor from front to back, gaining some efficient downforce."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "MSC Cruises Austrian GP",
    "Constructor": "STAKE F1 TEAM KICK SAUBER",
    "RequiredEventDisplay": "FORMULA 1 AUSTRIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Rear Wing",
    "PrimaryReason": "Performance - Local Load",
    "GeometricDifferences": "New rear wing assembly.",
    "Description": "New rear wing assembly suited for higher downforce tracks. Overall reshaped geometry with a more efficient load distribution. Covers a variety of tracks until the end of the season."
  },
      {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "MCLAREN F1 TEAM",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Rear Wing",
    "PrimaryReason": "Circuit specific - Drag Range",
    "GeometricDifferences": "New Low Downforce Rear Wing",
    "Description": "Updated version of the low downforce rear wing assembly, improving overall efficiency across a similar drag range, suitable for multiple circuits."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "SCUDERIA FERRARI HP",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Rear Suspension",
    "PrimaryReason": "Performance - Local Load",
    "GeometricDifferences": "Updated Rear Suspension geometry and rear corner winglet elements",
    "Description": ""
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "SCUDERIA FERRARI HP",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Rear Corner",
    "PrimaryReason": "Performance - Local Load",
    "GeometricDifferences": "",
    "Description": ""
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "SCUDERIA FERRARI HP",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 3,
    "UpdatedComponent": "Rear Wing",
    "PrimaryReason": "Circuit specific - Drag Range",
    "GeometricDifferences": "Rear wing flap element trim",
    "Description": "Given the aerodynamic efficiency requirements of the Spa-Francorchamps circuit, a lower downforce modulation will be made available, reducing the chord of the rear wing flap element"
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Red Bull Racing",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Front Wing",
    "PrimaryReason": "Performance - Local Load",
    "GeometricDifferences": "First and second elements both have revised camber and incidence. As a consequence of the regulations, elements three and four had to be adapted.",
    "Description": "The geometric changes revise the pressure distribution across primarily the first two elements of the assembled wing raising the overall load derived from the assembly."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Red Bull Racing",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Sidepod Inlet",
    "PrimaryReason": "Reliability",
    "GeometricDifferences": "Two inlets merged into one and the upper portion has widened",
    "Description": "Noting the tracks approaching which challenge the Power Unit cooling systems, the inlet to the sidepod radiators has been enlarged to exploit better pressure now available."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Red Bull Racing",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 3,
    "UpdatedComponent": "Coke/Engine Cover",
    "PrimaryReason": "Reliability",
    "GeometricDifferences": "Changed by consequence of the sidepod inlet revisions to align and then blend to the floor.",
    "Description": "Having changed the sidepod inlet and therefore the split lines to the sidepod part of the topbody, the engine cover has been revised to link the sidepod to the floor, maintaining the same cooling exit louvre options. The inboard rear suspension shrouds have been revised to suit the new topbody despite attaching to the bonded gearbox assembly."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Red Bull Racing",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 4,
    "UpdatedComponent": "Front suspension",
    "PrimaryReason": "Flow conditioning",
    "GeometricDifferences": "Revised inboard fairings on the top wishbone adding more camber",
    "Description": "These fairings blending between suspension and chassis surfaces aid the pressure available at the new sidepod inlet, therefore enhancing the cooling."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "PENDING_Red Bull RacingTEAM",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 5,
    "UpdatedComponent": "Rear corner",
    "PrimaryReason": "Performance - Local Load",
    "GeometricDifferences": "Mirror changes to the profile of the lower cascade to add camber",
    "Description": "The rear wheel bodywork lower cascade wing assembly has locally more camber and a trailing edge trim to the endplate adding load whilst maintaining flow stability."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "MERCEDES-AMG PETRONAS F1 TEAM",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Front Wing",
    "PrimaryReason": "Performance – Flow Conditioning",
    "GeometricDifferences": "Increased chord of endplate second element.",
    "Description": "Increasing the chord on the front wing second element local to the endplate (and reducing the forward element chord), redistributes the tip vorticity and improves tyre squirt and lower wake control."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "MERCEDES-AMG PETRONAS F1 TEAM",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Rear Corner",
    "PrimaryReason": "Performance – Local Load",
    "GeometricDifferences": "Drum lip moved inboard.",
    "Description": "Moving the drum lip inboard increases vorticity shed off the top edge resulting in more outwash and improved rear tyre upper wake control."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Aston Martin Aramco F1 Team",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Front Wing",
    "PrimaryReason": "Circuit specific - Balance Range",
    "GeometricDifferences": "Front wing flap for the front wing used at the previous event with reduced chord.",
    "Description": "The front wing flap lowers the loading on the front wing to achieve the necessary balance with the lower rear wing expected to be used at this event."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Aston Martin Aramco F1 Team",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Front Wing",
    "PrimaryReason": "Performance - Local Load",
    "GeometricDifferences": "",
    "Description": "The front end package improves the flow on the"
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Aston Martin Aramco F1 Team",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 3,
    "UpdatedComponent": "Nose",
    "PrimaryReason": "Performance - Local Load",
    "GeometricDifferences": "Shorter nose with the wing mounted from the second element.",
    "Description": "The front end package improves the flow on the front wing assy generating improved performance through the operating range of the car."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Aston Martin Aramco F1 Team",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 4,
    "UpdatedComponent": "Rear Wing",
    "PrimaryReason": "Circuit specific - Drag Range",
    "GeometricDifferences": "Upper rear wing with smaller sections for reduced front view area.",
    "Description": "The rear wing and beam wing are less loaded than previous options to reduce drag in line with the expected setup for this circuit."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Aston Martin Aramco F1 Team",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 5,
    "UpdatedComponent": "Beam Wing",
    "PrimaryReason": "Circuit specific - Drag Range",
    "GeometricDifferences": "Single element beam wing.",
    "Description": "The rear wing and beam wing are less loaded than previous options to reduce drag in line with the expected setup for this circuit."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "BWT ALPINE F1 TEAM",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Rear wing",
    "PrimaryReason": "Circuit specific – Drag range",
    "GeometricDifferences": "Low downforce top rear wing",
    "Description": "The top rear wing has been redesigned and is less loaded. This reduces the drag efficiently and is an option for the upcoming tracks."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "BWT ALPINE F1 TEAM",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Beam wing",
    "PrimaryReason": "Circuit specific – Drag range",
    "GeometricDifferences": "Low downforce rear beam wing",
    "Description": "The beam wing has also been updated to offer an efficient alternative rear wing assembly, suitable for high efficiency tracks."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Visa Cash App Racing Bulls",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Rear Wing",
    "PrimaryReason": "Circuit specific - Drag Range",
    "GeometricDifferences": "Updated rear wing profiles.",
    "Description": "The upper rear wing has been changed to meet the needs of the target downforce & efficiency level for the circuit."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Visa Cash App Racing Bulls",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Rear Corner",
    "PrimaryReason": "Performance – Flow Conditioning",
    "GeometricDifferences": "The geometry of the winglets on the rear corner has been updated.",
    "Description": "The rear brake duct winglets have been modified in order to improve the flow conditioning around the rear of the car."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "Visa Cash App Racing Bulls",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 3,
    "UpdatedComponent": "Diffuser",
    "PrimaryReason": "Performance – Flow Conditioning",
    "GeometricDifferences": "Diffuser geometry has been updated.",
    "Description": "The shape of the diffuser has been revised in order to improve the flow conditioning around the rear of the car."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "ATLASSIAN WILLIAMS RACING",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 1,
    "UpdatedComponent": "Floor Fences",
    "PrimaryReason": "Performance - Flow Conditioning",
    "GeometricDifferences": "Each of the forward floor fences have been reprofiled to change their camber. The detailed geometry at the trailing edge of each fence has also been updated.",
    "Description": "The revised fence geometries redistribute the balance of loading through the floor fence channels. This increases the local front of floor loading as well as improving the potential for the downstream flow."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "ATLASSIAN WILLIAMS RACING",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 2,
    "UpdatedComponent": "Floor Edge",
    "PrimaryReason": "Performance - Local Load",
    "GeometricDifferences": "The floor edge wing and spat have been reprofiled with a more complex curvature. The lateral hole at the rear of the spat has also been subtly reshaped.",
    "Description": "These modified geometries capitalise on the revised local onset flow to not only improve local load along the edge of the floor but also to benefit the inlet condition to the main diffuser."
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "ATLASSIAN WILLIAMS RACING",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 3,
    "UpdatedComponent": "Sidepod Inlet",
    "PrimaryReason": "Performance - Flow Conditioning",
    "GeometricDifferences": "",
    "Description": "The revisions to the sidepod inlet work in combination with"
  },
  {
    "Year": 2025,
    "RaceNo": 12,
    "RaceName": "Moët & Chandon Belgian GP",
    "Constructor": "ATLASSIAN WILLIAMS RACING",
    "RequiredEventDisplay": "FORMULA 1 BELGIAN GRAND PRIX 2025",
    "ComponentNo": 4,
    "UpdatedComponent": "Coke/Engine Cover",
    "PrimaryReason": "Performance - Flow Conditioning",
    "GeometricDifferences": "",
    "Description": ""
  }
    ];


    let savedDetailsList = []; // In-memory storage for saved details

    // DOM Elements
    const raceNameSelect = document.getElementById('raceNameSelect');
    const teamNamesSelect = document.getElementById('teamNamesSelect');
    const upgradesNameSelect = document.getElementById('upgradesNameSelect');
    const teamDropdownContainer = document.getElementById('teamDropdownContainer');
    const upgradesDropdownContainer = document.getElementById('upgradesDropdownContainer');
    const detailsCard = document.getElementById('detailsCard');
    const detailPartName = document.getElementById('detailPartName');
    const detailPrimaryReason = document.getElementById('detailPrimaryReason');
    const detailGeometricDifferences = document.getElementById('detailGeometricDifferences');
    const detailDescription = document.getElementById('detailDescription');
    const saveDetailBtn = document.getElementById('saveDetailBtn');
    const showSavedDetailsBtn = document.getElementById('showSavedDetailsBtn');
    const savedCountSpan = document.getElementById('savedCount');
    const savedDetailsView = document.getElementById('savedDetailsView');
    const savedDetailsListContainer = document.getElementById('savedDetailsList');
    const backToMainBtn = document.getElementById('backToMainBtn');
    const mainContent = document.getElementById('mainContent');
    const customAlert = document.getElementById('customAlert');
    const alertMessage = document.getElementById('alertMessage');
    const closeAlertBtn = document.getElementById('closeAlertBtn');

    // Spoiler Elements
    const spoilerSectionInCard = document.getElementById('spoilerSectionInCard');
    const spoilerToggle = document.getElementById('spoilerToggle');
    const spoilerContent = document.getElementById('spoilerContent');
    const spoilerResults = document.getElementById('spoilerResults');


    // --- Spoiler Feature Functions ---
    const API_BASE_URL = "https://api.openf1.org/v1";
    const YEAR = 2025; // Use 2025 data
    let sessionCache = {}; // Cache for session keys to reduce API calls

    async function getSession(location, sessionType) {
      const cacheKey = `${location}-${sessionType}-${YEAR}`;
      if (sessionCache[cacheKey]) {
        return sessionCache[cacheKey];
      }
      try {
        const resp = await fetch(`${API_BASE_URL}/sessions?year=${YEAR}&location=${location}&session_name=${sessionType}`);
        if (!resp.ok) throw new Error(`API error: ${resp.statusText}`);
        let sessions = await resp.json();

        if (sessions.length === 0) { // Fallback for circuit names
          const circuitResp = await fetch(`${API_BASE_URL}/sessions?year=${YEAR}&circuit_short_name=${location}&session_name=${sessionType}`);
          if (circuitResp.ok) sessions = await circuitResp.json();
        }

        if (sessions.length > 0) {
          sessions.sort((a, b) => new Date(b.date_start) - new Date(a.date_start));
          sessionCache[cacheKey] = sessions[0];
          return sessions[0];
        }
        return null;
      } catch (error) {
        console.error(`Error fetching ${sessionType} session for ${location}:`, error);
        return null;
      }
    }

    async function getDriverDetails(driverNumber) {
      try {
        const resp = await fetch(`${API_BASE_URL}/drivers?driver_number=${driverNumber}&session_key=latest`);
        if (!resp.ok) return { name: 'Unknown Driver' };
        const data = await resp.json();
        return data[0] ? { name: data[0].full_name, team: data[0].team_name } : { name: 'Unknown Driver' };
      } catch (error) {
        console.error(`Error fetching details for driver ${driverNumber}:`, error);
        return { name: 'Unknown Driver' };
      }
    }

    async function fetchRaceSpoilers(location, raceDate) {
      const raceSession = await getSession(location, "Race");
      const qualiSession = await getSession(location, "Qualifying");

      if (!raceSession) {
        return { error: `Race results not yet available for ${location}.` };
      }

      let poleSitter = { name: "N/A" };
      if (qualiSession) {
        try {
          const qualiResults = await fetch(`${API_BASE_URL}/session_result?session_key=${qualiSession.session_key}&position=1`).then(r => r.json());
          if (qualiResults.length > 0) {
            poleSitter = await getDriverDetails(qualiResults[0].driver_number);
          }
        } catch (e) { console.error("Error fetching qualifier:", e); }
      }

      let finishers = [];
      try {
        const raceResults = await fetch(`${API_BASE_URL}/session_result?session_key=${raceSession.session_key}`).then(r => r.json());
        const topThree = raceResults.filter(d => d.position >= 1 && d.position <= 3).sort((a, b) => a.position - b.position);

        for (const driver of topThree) {
          const details = await getDriverDetails(driver.driver_number);
          finishers.push({
            position: driver.position,
            name: details.name
          });
        }
      } catch (e) {
        console.error("Error fetching race finishers:", e);
        return { error: 'Could not fetch race finishers.' };
      }

      return { poleSitter, finishers };
    }


    async function updateSpoilers() {
      const selectedRaceName = raceNameSelect.value;
      if (!selectedRaceName) return;

      const raceData = raceSchedule.find(r => r.name === selectedRaceName);
      if (!raceData || !raceData.location) {
        spoilerResults.innerHTML = `<p class="text-amber-500">Spoiler data configuration missing for this event.</p>`;
        return;
      }

      spoilerResults.innerHTML = `<p>Loading spoiler data for ${selectedRaceName}...</p>`;

      const { poleSitter, finishers, error } = await fetchRaceSpoilers(raceData.location, raceData.raceDate);

      if (error) {
        spoilerResults.innerHTML = `<p class="text-red-500">${error}</p>`;
        return;
      }

      const medals = ['🥇', '🥈', '🥉'];

      let resultsHtml = `<div class="space-y-4">`;
      resultsHtml += `
                <div>
                    <p class="text-sm text-gray-400">Top Qualifier</p>
                    <p class="text-lg font-bold text-red-400">${poleSitter.name}</p>
                </div>
            `;

      if (finishers.length > 0) {
        resultsHtml += `<div><p class="text-sm text-gray-400">Podium Finishers</p><ul class="space-y-2 mt-2">`;
        finishers.forEach(f => {
          resultsHtml += `
                        <li class="flex justify-between items-center bg-gray-900 p-2 rounded-md">
                            <div>
                                <span class="text-xl w-8 inline-block">${medals[f.position - 1]}</span>
                                <span class="font-semibold">${f.name}</span>
                            </div>
                        </li>`;
        });
        resultsHtml += `</ul></div>`;
      } else {
        resultsHtml += `<p>Podium data is not available.</p>`;
      }

      resultsHtml += `</div>`;
      spoilerResults.innerHTML = resultsHtml;
    }


    // --- Utility Functions ---

    function calculateCountdown(targetDate) {
      const now = new Date();
      const distance = targetDate.getTime() - now.getTime();

      if (distance < 0) {
        return null; // Race has passed
      }

      const days = Math.floor(distance / (1000 * 60 * 60 * 24));
      const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));

      return { days, hours, minutes };
    }

    function updateCountdown() {
      const now = new Date();
      let nextRace = null;

      // Sort races by date to ensure we find the correct next one
      const sortedRaces = [...raceSchedule].sort((a,b) => a.raceDate - b.raceDate);

      for (const race of sortedRaces) {
        if (race.raceDate > now) {
          nextRace = race;
          break;
        }
      }

      if (nextRace) {
        const countdown = calculateCountdown(nextRace.raceDate);
        document.getElementById('nextRaceName').textContent = nextRace.name;
        document.getElementById('nextRaceCircuit').textContent = nextRace.circuit;
        document.getElementById('countdownDays').textContent = countdown ? countdown.days : 0;
        document.getElementById('countdownHours').textContent = countdown ? countdown.hours : 0;
        document.getElementById('countdownMinutes').textContent = countdown ? countdown.minutes : 0;
      } else {
        document.getElementById('nextRaceName').textContent = "Season Finished";
        document.getElementById('nextRaceCircuit').textContent = "Check back for the next season!";
        document.getElementById('countdownDays').textContent = '0';
        document.getElementById('countdownHours').textContent = '0';
        document.getElementById('countdownMinutes').textContent = '0';
      }
    }

    function showAlert(message) {
      alertMessage.textContent = message;
      customAlert.classList.remove('hidden');
    }

    function closeAlert() {
      customAlert.classList.add('hidden');
    }

    // --- Dropdown Population Functions ---

    function populateRaceNames() {
      // Sort races by date before populating
      const sortedRaces = [...raceSchedule].sort((a,b) => a.raceDate - b.raceDate);
      const raceNames = sortedRaces.map(item => item.name);
      raceNameSelect.innerHTML = '<option value="" disabled selected>Select a Race Name</option>';
      raceNames.forEach(name => {
        const option = document.createElement('option');
        option.value = name;
        option.textContent = name;
        raceNameSelect.appendChild(option);
      });
    }

    function populateConstructors(selectedRace) {
      const filteredData = upgradeData.filter(item => item.RaceName === selectedRace);
      const constructors = [...new Set(filteredData.map(item => item.Constructor))];

      teamNamesSelect.innerHTML = '<option value="" disabled selected>Select a Team Name</option>';
      constructors.forEach(name => {
        const option = document.createElement('option');
        option.value = name;
        option.textContent = name;
        teamNamesSelect.appendChild(option);
      });
      teamDropdownContainer.classList.remove('hidden');
    }

    function populateUpdatedComponents(selectedRace, selectedConstructor) {
      upgradesNameSelect.innerHTML = '<option value="" disabled selected>Select an Upgrade</option>';
      if (selectedRace && selectedConstructor) {
        const filteredData = upgradeData.filter(
          item => item.RaceName === selectedRace && item.Constructor === selectedConstructor
        );
        const components = [...new Set(filteredData.map(item => item.UpdatedComponent))];
        components.forEach(name => {
          const option = document.createElement('option');
          option.value = name;
          option.textContent = name;
          upgradesNameSelect.appendChild(option);
        });
        upgradesDropdownContainer.classList.remove('hidden');
      } else {
        upgradesDropdownContainer.classList.add('hidden');
      }
      upgradesNameSelect.value = '';
      detailsCard.classList.add('hidden');
    }

    function displayDetails(selectedRace, selectedConstructor, selectedComponent) {
      spoilerSectionInCard.classList.add('hidden'); // Hide spoilers by default
      saveDetailBtn.classList.remove('hidden');

      if (selectedRace && selectedConstructor && selectedComponent) {
        const foundDetail = upgradeData.find(
          item => item.RaceName === selectedRace &&
            item.Constructor === selectedConstructor &&
            item.UpdatedComponent === selectedComponent
        );

        if (foundDetail) {
          detailPartName.textContent = foundDetail.UpdatedComponent;
          detailPrimaryReason.textContent = foundDetail.PrimaryReason;
          detailGeometricDifferences.textContent = foundDetail.GeometricDifferences;
          detailDescription.textContent = foundDetail.Description;
          detailsCard.classList.remove('hidden');

          const raceData = raceSchedule.find(r => r.name === selectedRace);
          if (raceData && raceData.raceDate < new Date()) {
            spoilerSectionInCard.classList.remove('hidden');
            // Ensure toggle is off and content is hidden by default
            spoilerToggle.checked = false;
            spoilerContent.classList.add('max-h-0');
            spoilerContent.classList.remove('max-h-[150rem]');
          }

        } else {
          detailsCard.classList.add('hidden');
        }
      } else {
        detailsCard.classList.add('hidden');
      }
    }

    // --- Event Handlers ---

    raceNameSelect.addEventListener('change', (e) => {
      const selectedRace = e.target.value;

      teamDropdownContainer.classList.add('hidden');
      upgradesDropdownContainer.classList.add('hidden');
      detailsCard.classList.add('hidden');
      spoilerSectionInCard.classList.add('hidden');

      const hasUpgradeData = upgradeData.some(item => item.RaceName === selectedRace);

      if (hasUpgradeData) {
        populateConstructors(selectedRace);
      } else { 
          const raceData = raceSchedule.find(r => r.name === selectedRace);
          if (raceData && raceData.raceDate < new Date()) {
            detailPartName.textContent = "N/A";
            detailPrimaryReason.textContent = "N/A";
            detailGeometricDifferences.textContent = "N/A";
            detailDescription.textContent = "No specific upgrade data available for this race.";
            detailsCard.classList.remove('hidden');
            saveDetailBtn.classList.add('hidden');
            spoilerSectionInCard.classList.remove('hidden');
            
            spoilerToggle.checked = false;
            spoilerContent.classList.add('max-h-0');
            spoilerContent.classList.remove('max-h-[150rem]');
          } else {
            saveDetailBtn.classList.remove('hidden');
          }
      }
    });

    teamNamesSelect.addEventListener('change', (e) => {
      const selectedConstructor = e.target.value;
      populateUpdatedComponents(raceNameSelect.value, selectedConstructor);
      displayDetails(raceNameSelect.value, selectedConstructor, upgradesNameSelect.value);
    });

    upgradesNameSelect.addEventListener('change', (e) => {
      const selectedComponent = e.target.value;
      displayDetails(raceNameSelect.value, teamNamesSelect.value, selectedComponent);
    });

    spoilerToggle.addEventListener('change', () => {
        if (spoilerToggle.checked) {
            spoilerContent.classList.remove('max-h-0');
            spoilerContent.classList.add('max-h-[150rem]');
            updateSpoilers();

            const selectedRaceName = raceNameSelect.value;
            const raceData = raceSchedule.find(r => r.name === selectedRaceName);
            
            if (typeof initializeComparisonForRace === 'function') {
                if (raceData && raceData.apiMeetingName) {
                    initializeComparisonForRace(raceData.apiMeetingName, raceData.name);
                } else {
                    initializeComparisonForRace(null, selectedRaceName);
                }
            }
        } else {
            spoilerContent.classList.add('max-h-0');
            spoilerContent.classList.remove('max-h-[150rem]');
        }
    });


    saveDetailBtn.addEventListener('click', () => {
      const currentDetails = {
        updatedComponent: detailPartName.textContent,
        primaryReason: detailPrimaryReason.textContent,
        geometricDifferences: detailGeometricDifferences.textContent,
        description: detailDescription.textContent,
        raceName: raceNameSelect.value,
        constructor: teamNamesSelect.value,
        id: Date.now()
      };

      if (!currentDetails.updatedComponent) {
        showAlert("Please select an upgrade to save details.");
        return;
      }

      const isDuplicate = savedDetailsList.some(item =>
        item.raceName === currentDetails.raceName &&
        item.constructor === currentDetails.constructor &&
        item.updatedComponent === currentDetails.updatedComponent
      );

      if (isDuplicate) {
        showAlert("This detail card is already saved!");
        return;
      }

      savedDetailsList.push(currentDetails);
      updateSavedCount();
      showAlert("Detail saved successfully to app memory!");

      raceNameSelect.value = '';
      teamDropdownContainer.classList.add('hidden');
      upgradesDropdownContainer.classList.add('hidden');
      detailsCard.classList.add('hidden');
      spoilerSectionInCard.classList.add('hidden');
    });

    showSavedDetailsBtn.addEventListener('click', () => {
      mainContent.classList.add('hidden');
      detailsCard.classList.add('hidden');
      spoilerSectionInCard.classList.add('hidden');
      savedDetailsView.classList.remove('hidden');
      renderSavedDetails();
    });

    backToMainBtn.addEventListener('click', () => {
      savedDetailsView.classList.add('hidden');
      mainContent.classList.remove('hidden');
      raceNameSelect.value = '';
      teamDropdownContainer.classList.add('hidden');
      upgradesDropdownContainer.classList.add('hidden');
      detailsCard.classList.add('hidden');
      spoilerSectionInCard.classList.add('hidden');
    });

    closeAlertBtn.addEventListener('click', closeAlert);

    function updateSavedCount() {
      savedCountSpan.textContent = savedDetailsList.length;
    }

    function renderSavedDetails() {
      savedDetailsListContainer.innerHTML = '';
      if (savedDetailsList.length === 0) {
        savedDetailsListContainer.innerHTML = '<p class="text-gray-400 text-center col-span-full">No details saved yet.</p>';
      } else {
        savedDetailsList.forEach(item => {
          const detailDiv = document.createElement('div');
          detailDiv.className = `bg-gray-700 border border-gray-600 p-5 rounded-lg shadow-md cursor-pointer
                                           hover:bg-gray-600 hover:scale-105 transition-all duration-200 ease-in-out relative`;
          detailDiv.innerHTML = `
                        <p class="font-semibold text-blue-300 text-lg mb-2">${item.updatedComponent}</p>
                        <p class="text-sm text-gray-300">Race: ${item.raceName}</p>
                        <p class="text-sm text-gray-300">Team: ${item.constructor}</p>
                        <p class="text-sm text-gray-400 mt-2 line-clamp-3">${item.description}</p>
                        <button class="remove-saved-detail-btn absolute top-2 right-2 bg-red-600 hover:bg-red-700 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold" data-id="${item.id}">
                            X
                        </button>
                    `;
          detailDiv.addEventListener('click', () => handleViewSavedDetail(item));

          detailDiv.querySelector('.remove-saved-detail-btn').addEventListener('click', (e) => {
            e.stopPropagation();
            handleRemoveSavedDetail(parseInt(e.target.dataset.id));
          });

          savedDetailsListContainer.appendChild(detailDiv);
        });
      }
    }

    function handleRemoveSavedDetail(idToRemove) {
      savedDetailsList = savedDetailsList.filter(item => item.id !== idToRemove);
      updateSavedCount();
      renderSavedDetails();
    }

    function handleViewSavedDetail(item) {
      savedDetailsView.classList.add('hidden');
      mainContent.classList.remove('hidden');

      spoilerSectionInCard.classList.add('hidden');
      if (spoilerToggle.checked) {
        spoilerToggle.checked = false;
        spoilerContent.classList.add('max-h-0');
        spoilerContent.classList.remove('max-h-[150rem]');
      }

      raceNameSelect.value = item.raceName;

      const hasUpgradeData = upgradeData.some(d => d.RaceName === item.raceName);
      if (hasUpgradeData) {
        populateConstructors(item.raceName);
        teamNamesSelect.value = item.constructor;
        populateUpdatedComponents(item.raceName, item.constructor);
        upgradesNameSelect.value = item.updatedComponent;
        displayDetails(item.raceName, item.constructor, item.updatedComponent);
      } else {
        teamDropdownContainer.classList.add('hidden');
        upgradesDropdownContainer.classList.add('hidden');
        detailsCard.classList.add('hidden');
      }
    }


    // --- Initial Setup on Window Load ---
    window.onload = function () {
      populateRaceNames();
      updateCountdown();
      setInterval(updateCountdown, 60000);
      updateSavedCount();
    };
  </script>
  <script>
    // --- START: INTEGRATED DRIVER COMPARISON SCRIPT ---
    (function() {
        // --- CONFIGURATION ---
        const OPENF1_API_BASE_URL = 'https://api.openf1.org/v1';

        // --- DOM ELEMENTS ---
        const mainContainer = document.querySelector('.session-container');

        // --- APP STATE ---
        let currentChart = null;
        const apiCache = new Map();

        // --- VIEW RENDERING ---
        function renderView(html) {
            mainContainer.innerHTML = html;
        }

        function getCompareViewHTML() {
            return `
                <h2 class="text-xl font-bold text-white mb-2">Compare Driver Performance</h2>
                <div id="comparison-race-context" class="mb-4 p-3 bg-gray-900/50 rounded-lg border border-gray-700">
                    <p class="text-gray-400">For Race: <span id="comparison-race-name" class="font-bold text-white">Not Selected</span></p>
                </div>
                <div class="filters flex gap-4 mb-4">
                    <label for="session-select-compare" class="text-lg font-bold text-blue-400 self-center">Session:</label>
                    <select id="session-select-compare" class="flex-grow bg-gray-900 text-gray-200 border border-gray-600 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500"><option value="Race">Race</option><option value="Qualifying">Qualifying</option></select>
                </div>
                <div id="driver-selection" class="hidden flex-wrap gap-4 items-center mb-6 bg-gray-900/50 p-4 rounded-lg border border-gray-700">
                    <select id="driver1-select" class="flex-1 bg-gray-900 text-gray-200 border border-gray-600 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500"></select>
                    <span class="text-gray-400 font-bold">vs</span>
                    <select id="driver2-select" class="flex-1 bg-gray-900 text-gray-200 border border-gray-600 rounded-md p-3 focus:outline-none focus:ring-2 focus:ring-blue-500"></select>
                    <button id="compare-btn" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-300 shadow-xl font-bold">Compare</button>
                </div>
                <div id="loader" class="text-center p-4 text-gray-300" style="display:none;"></div>
                <div id="error" class="text-center p-4 text-red-400 bg-red-900/40 border border-red-700 rounded-lg" style="display: none;"></div>
                <div id="results-content" style="display: none;">
                    <div id="fastest-lap-section" class="mb-8 p-6 bg-gray-900/50 rounded-lg border border-gray-700"></div>
                    <div id="compare-results">
                        <canvas id="compareChart"></canvas>
                    </div>
                </div>
            `;
        }

        async function populateDriverSelectForCompare() {
            showLoader('Loading driver data...');
            const meetingKey = mainContainer.dataset.meetingKey;
            const sessionType = document.getElementById('session-select-compare').value;
            const year = mainContainer.dataset.year;
            
            const errorEl = document.getElementById('error');
            if (errorEl) errorEl.style.display = 'none';

            if (!meetingKey) {
                showError("No race event key found.");
                hideLoader();
                return;
            }

            const sessions = await fetchData(OPENF1_API_BASE_URL, `sessions?meeting_key=${meetingKey}`);
            if (!sessions) { hideLoader(); return; }
            
            const session = sessions.find(s => s.session_name === sessionType);
            if (!session) {
                showError(`'${sessionType}' session not found for this event.`);
                document.getElementById('driver-selection').style.display = 'none';
                hideLoader();
                return;
            }

            const drivers = await fetchData(OPENF1_API_BASE_URL, `drivers?session_key=${session.session_key}`);
            if (!drivers || drivers.length === 0) {
                showError(`No drivers found for the '${sessionType}' session.`);
                document.getElementById('driver-selection').style.display = 'none';
                hideLoader();
                return;
            }

            const d1Select = document.getElementById('driver1-select');
            const d2Select = document.getElementById('driver2-select');
            d1Select.innerHTML = '';
            d2Select.innerHTML = '';
            drivers.sort((a, b) => a.full_name.localeCompare(b.full_name)).forEach(d => {
                d1Select.innerHTML += `<option value="${d.driver_number}">${d.full_name}</option>`;
                d2Select.innerHTML += `<option value="${d.driver_number}">${d.full_name}</option>`;
            });

            if (d2Select.options.length > 1) {
                d2Select.selectedIndex = 1;
            }
            document.getElementById('driver-selection').style.display = 'flex';
            hideLoader();
        }

        async function displayCompareData() {
            showLoader('Fetching Session Data...');
            const meetingKey = mainContainer.dataset.meetingKey;
            const sessionType = document.getElementById('session-select-compare').value;
            const driver1 = document.getElementById('driver1-select').value;
            const driver2 = document.getElementById('driver2-select').value;
            
            if (driver1 === driver2) {
                showError("Please select two different drivers.");
                hideLoader();
                return;
            }

            const sessions = await fetchData(OPENF1_API_BASE_URL, `sessions?meeting_key=${meetingKey}`);
            if (!sessions) { hideLoader(); return; }

            const session = sessions.find(s => s.session_name === sessionType);
            if (!session) {
                showError("Could not find the selected session.");
                hideLoader();
                return;
            }
            
            const [laps, drivers] = await Promise.all([
                fetchData(OPENF1_API_BASE_URL, `laps?session_key=${session.session_key}`),
                fetchData(OPENF1_API_BASE_URL, `drivers?session_key=${session.session_key}`)
            ]);

            if (!laps || !drivers || laps.length === 0 || drivers.length === 0) {
                showError("Could not load lap or driver data for this session.");
                hideLoader();
                return;
            }

            const driverMap = new Map(drivers.map(d => [d.driver_number, d]));
            
            const fastestLap = findFastestLap(laps, driverMap);
            renderFastestLap(fastestLap);

            renderLapGapChart(laps, driverMap, [parseInt(driver1), parseInt(driver2)], 'compareChart');
            
            hideLoader();
        }

        function findFastestLap(laps, driverMap) {
            const validLaps = laps.filter(l => l.lap_duration);
            if (validLaps.length === 0) return null;
            const fastest = validLaps.reduce((f, c) => c.lap_duration < f.lap_duration ? c : f);
            fastest.driver_info = driverMap.get(fastest.driver_number);
            return fastest;
        }
        
        function renderFastestLap(lap) {
            const container = document.getElementById('fastest-lap-section');
            if (!lap || !lap.driver_info) {
                container.innerHTML = `<h2 class="text-lg font-bold text-white mb-2">Fastest Lap</h2><p class="text-gray-400">Data not available.</p>`;
                return;
            }
            const minutes = Math.floor(lap.lap_duration / 60);
            const seconds = (lap.lap_duration % 60).toFixed(3);
            const timeString = `${minutes}:${seconds.toString().padStart(6, '0')}`;
            container.innerHTML = `
                <h2 class="text-lg font-bold text-white mb-3">Fastest Lap of the Session</h2>
                <div class="fastest-lap-info text-center">
                    <div class="time text-4xl font-extrabold text-amber-400 tracking-wider">${timeString}</div>
                    <div class="driver text-xl font-semibold text-white mt-2">${lap.driver_info.full_name}</div>
                    <div class="lap text-md text-gray-400">on Lap ${lap.lap_number}</div>
                </div>`;
        }

        function renderLapGapChart(laps, driverMap, driverNumbers, canvasId) {
            if (currentChart) {
                currentChart.destroy();
            }
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;

            const validLaps = laps.filter(l => l.lap_duration);
            if (validLaps.length === 0) {
                canvas.style.display = 'none';
                showError("No valid lap data available to generate a chart.", true);
                return;
            }
            canvas.style.display = 'block';

            const driver1Info = driverMap.get(driverNumbers[0]);
            const driver2Info = driverMap.get(driverNumbers[1]);

            const driver1Laps = new Map(validLaps.filter(l => l.driver_number === driverNumbers[0]).map(l => [l.lap_number, l.lap_duration]));
            const driver2Laps = new Map(validLaps.filter(l => l.driver_number === driverNumbers[1]).map(l => [l.lap_number, l.lap_duration]));

            const allLapNumbers = [...new Set([...driver1Laps.keys(), ...driver2Laps.keys()])].sort((a, b) => a - b);

            const gapData = [];
            const backgroundColors = [];
            
            const color1 = `#${driver1Info.team_colour || '999999'}`;
            const color2 = `#${driver2Info.team_colour || 'CCCCCC'}`;

            for (const lapNum of allLapNumbers) {
                const lap1Time = driver1Laps.get(lapNum);
                const lap2Time = driver2Laps.get(lapNum);

                if (lap1Time && lap2Time) {
                    const gap = lap1Time - lap2Time;
                    gapData.push(gap);
                    backgroundColors.push(gap <= 0 ? color1 : color2);
                } else {
                    gapData.push(null);
                    backgroundColors.push('transparent');
                }
            }
            
            currentChart = new Chart(canvas.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: allLapNumbers,
                    datasets: [{
                        label: 'Gap (s)',
                        data: gapData,
                        backgroundColor: backgroundColors,
                        borderColor: backgroundColors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                           display: false
                        },
                        title: {
                            display: true,
                            text: `Lap Time Gap: ${driver1Info.full_name} vs. ${driver2Info.full_name}`,
                            color: '#c9d1d9',
                            font: { size: 16 }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const gapInSeconds = context.parsed.y;
                                    if (gapInSeconds === null) return 'No comparable lap time';
                                    
                                    const gapInMilliseconds = Math.abs(gapInSeconds * 1000);
                                    const formattedSeconds = Math.abs(gapInSeconds).toFixed(3);

                                    if (gapInSeconds <= 0) {
                                        return `${driver1Info.full_name} was faster by: ${formattedSeconds}s (${gapInMilliseconds.toFixed(0)}ms)`;
                                    } else {
                                        return `${driver1Info.full_name} was slower by: ${formattedSeconds}s (${gapInMilliseconds.toFixed(0)}ms)`;
                                    }
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            title: { display: true, text: 'Lap Number', color: '#8b949e' }, 
                            ticks: { color: '#8b949e' },
                            grid: { color: '#374151' }
                        },
                        y: { 
                            title: { display: true, text: `Gap to ${driver2Info.full_name} (s)`, color: '#8b949e' }, 
                            ticks: { color: '#8b949e' },
                            grid: { color: '#374151' }
                        }
                    }
                }
            });
        }

        async function fetchData(baseUrl, endpoint) {
            const url = `${baseUrl}/${endpoint}`;
            if (apiCache.has(url)) {
                return apiCache.get(url);
            }
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error(`API Error: ${response.status} for ${url}`);
                const data = await response.json();
                apiCache.set(url, data);
                return data;
            } catch (error) {
                console.error(`Error fetching ${endpoint}:`, error);
                showError(error.message);
                return null;
            }
        }
        
        function showLoader(message) {
            const loader = document.getElementById('loader');
            if (loader) {
                loader.textContent = message;
                loader.style.display = 'block';
            }
            document.getElementById('results-content').style.display = 'none';
            const error = document.getElementById('error');
            if (error) error.style.display = 'none';
        }

        function hideLoader() {
            const loader = document.getElementById('loader');
            if (loader) loader.style.display = 'none';
            document.getElementById('results-content').style.display = 'block';
        }

        function showError(message, isSoftError = false) {
            const error = document.getElementById('error');
            if (error) {
                error.textContent = message;
                error.style.display = 'block';
            }
            const loader = document.getElementById('loader');
            if (loader) loader.style.display = 'none';
            if (!isSoftError) {
                document.getElementById('results-content').style.display = 'none';
            }
        }
        
        window.initializeComparisonForRace = async function(apiMeetingName, displayName) {
            renderView(getCompareViewHTML());
            const year = "2025"; 
            mainContainer.dataset.year = year;
            document.getElementById('comparison-race-name').textContent = displayName || 'N/A';
            
            document.getElementById('session-select-compare').addEventListener('change', populateDriverSelectForCompare);
            document.getElementById('compare-btn').addEventListener('click', displayCompareData);
            
            if (!apiMeetingName) {
                showError(`API mapping not found for "${displayName}". Cannot fetch race data.`);
                return;
            }
            
            showLoader('Finding Race Data...');

            const meetings = await fetchData(OPENF1_API_BASE_URL, `meetings?year=${year}`);
            if (!meetings) {
                showError("Could not load race event data from API.");
                hideLoader();
                return;
            }

            let meeting = meetings.find(m => m.meeting_name === apiMeetingName);
            
            if (!meeting) {
                showError(`Could not find a matching event for "${apiMeetingName}" in the API.`);
                hideLoader();
                return;
            }

            mainContainer.dataset.meetingKey = meeting.meeting_key;
            await populateDriverSelectForCompare();
        }
    })();
    // --- END: INTEGRATED DRIVER COMPARISON SCRIPT ---
  </script>
</body>

</html>
